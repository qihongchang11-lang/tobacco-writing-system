
# CNIPA 发明专利高质量改写系统 — 项目需求文档（PRD 摘要版）
> 目标：让 AI 平台（我/GPT‑5 Thinking、Codex、Kimi K2）快速、准确理解并协作实现从**草稿**到**四件套**（说明书/权利要求/摘要/交底书）的端到端生产流水线。

---

## 1. 项目背景与总体目标
- **背景**：研发/生产场景中存在大量“设备改进/工艺优化”的零散资料，需要快速改写为**中国国家知识产权局（CNIPA）合规**的专利申请材料。
- **总体目标**：构建一个可落地的“高质量改写系统”，实现：
  1) 从草稿到**说明书/权利要求书/摘要（含摘要附图）/技术交底书**的自动化生成；  
  2) 跨文档**术语/部件号/图号/变量/单位**一致；  
  3) **合规校验**（清楚性/支持性/单一性/单句、引用、禁词、区间逻辑、背景泄露、摘要≤300字）；  
  4) 可导出 DOCX/LaTeX/PDF，提供**追溯表**与**质量报告**；  
  5) 在 GitHub PR + Actions 中**自动检查与出报告**，实现可回归、可量化。

---

## 2. 明确你的目的与任务
- **你的目的**：以较低门槛和高质量标准，批量把内部创新想法转化为可提交 CNIPA 的专利文书，并建立可复制的协作与验收机制。  
- **你的任务**：
  - 作为项目 Owner：提供草稿与业务约束，决策权利要求布局（装置/方法/用途/组合）。
  - 验收成品：对照 Gates（见 §6）和 DoD（见 §7）签字确认。
  - 推动平台协作：使用统一**任务卡（YAML）**与**数据协议（JSON/Schema）**，发起/合并 PR。
- **我的职责（GPT‑5 Thinking）**：系统设计、SOP/模板/Schema、规则库、首版四件套、AI 评审与修订建议。
- **Codex**：实现与运行**检查器/导出器/CI**、批量重构、PR 产出报告。
- **Kimi K2**：中文长文与术语一致性润色（不改变技术含义）。

---

## 3. 交付物（Artifacts）
- 四件套：`spec.md`、`claims.md`、`abstract.md`、`disclosure.md`  
- 追溯表：`trace_map.json`（权利要求特征 ↔ 说明书段落 ↔ 图号 ↔ 部件号）  
- 术语/标号词典：`dictionary.json`（术语/别名/英文、部件号映射、变量与单位）  
- 质量/合规报告：`qc_report.json`（结构/合规/一致性/区间逻辑/禁词/摘要等）  
- 可分发文档：`.docx`/`.tex`/`.pdf`（由导出器生成）  
- 任务卡：`jobcards/*.yaml`（端到端/实现检查器等）

---

## 4. 范围（In/Out of Scope）
- **In Scope**：中文专利撰写（发明为主）；CNIPA 规范；结构化改写、校验、导出、CI 评测。  
- **Out of Scope（当前阶段）**：跨国差异化撰写（PCT/USPTO 细则不在本期）、先验检索与答复审查意见（可作为后续阶段）。

---

## 5. 协作与工作流（平台间配合）
### 5.1 流程
1) **你 → 我**：提交草稿（`data/drafts/*.md`）。  
2) **我（GPT‑5）**：抽取 P/S/E、KTF DAG；生成四件套与追溯表、词典。  
3) **Kimi K2**：对四件套做中文润色与术语一致性审校（不改技术含义）。  
4) **Codex**：运行检查器 → 自动修复可机械问题 → 导出文档 → 生成 `qc_report.json`。  
5) **你**：在 PR 中查看报告与差分，基于 Gates/DoD 决策合入。

### 5.2 统一接口
- **任务卡（YAML）**：描述输入/约束/代理/产物/质量门；示例：`jobcards/run_pipeline.yaml`。  
- **数据协议（JSON/Schema）**：统一字段与结构：`schema/patent_schema.json`。

### 5.3 CI/CD
- 通过 GitHub Actions（`.github/workflows/patent-pipeline.yml`）在 PR 上自动执行：
  - 结构与合规检查（生成 `runs/**/qc_report.json`）
  - 失败即红灯（`fail_on_gates.py`）
  - 报告作为 Artifact 上传，便于下载归档

---

## 6. 质量门（Gates）——合入前的硬约束
- **Gate‑A**：KTF 完整度 ≥ 90%  
- **Gate‑B**：支持性 = 100%（权利要求特征在实施例可追溯）  
- **Gate‑C**：术语/部件/图号/变量/单位一致性错误 = 0  
- **Gate‑D**：禁词 = 0（最佳/领先/世界第一/革命性/超强/极致/无与伦比/显著…）  
- **Gate‑E**：摘要 ≤ 300 字（附图标记加括号）  
- **Gate‑F**：背景不泄露方案（语义重合率低于阈值）

---

## 7. 文档 DoD（Definition of Done）
- **说明书**：五章结构齐备（技术领域/背景技术/发明内容/附图说明/具体实施方式）；必要 KTF 在实施例支持；效果可回指；一致性 0 缺陷。  
- **权利要求**：主项=最小充分集、单句；从属项≥8–12 条、每条单一限定；引用合法；参数区间逻辑正确。  
- **摘要**：120–300 字；包含领域+对象+1–2 核心特征+用途/效果；附图标记括号化；清晰度达标。  
- **交底书**：字段完备；与 claims 预布局一致；数据/图可追溯。

---

## 8. 数据与模板（摘录）
- **Schema 主体**：`meta`、`dictionary`、`pse_matrix`、`drawings`、`claims`、`specification`、`abstract`、`quality_checks`。  
- **权利要求骨架（装置）**：  
  `一种___装置，其特征在于，包括：A___；B___与A___连接，用于___；其中，___参数为___。`  
- **权利要求骨架（方法）**：  
  `一种___方法，其特征在于，包括步骤：S1___；S2___；S3___；其中，___条件为___。`  
- **摘要模板**：  
  `本发明涉及___领域，公开了一种___。该___包括___与___，二者___以在___条件下实现___，从而使___指标达到___。（附图标记以括号标注）`

---

## 9. 实施计划（建议两周原型）
- **D1–3**：输入归一化、P/S/E、KTF、术语/标号词典  
- **D4–7**：Claims‑Gen + 合规检查器（单句/引用/禁词/区间/支持性）  
- **D8–10**：Spec/Abstract/Disclosure 生成 + 图/标号联动  
- **D11–14**：Gates 面板、导出、版本树、Actions 拉通

---

## 10. 风险与规避
- **术语/标号漂移** → 全局词典 + 一致性校验 + 自动替换建议  
- **结果性限定/区间无支撑** → 规则提示 + 追溯强制覆盖  
- **协作碎片化** → 统一 Job Card 与 Schema；PR only；CI 红灯拦截  
- **润色改变技术含义** → Kimi 仅限语言层；技术修改回到 GPT‑5 + Owner 审核

---

## 11. 你现在马上可以做的事（Checklist）
- [ ] 新建 GitHub 仓库并导入“平台协作入门包”  
- [ ] 将你的草稿放入 `data/drafts/` 并更新 `jobcards/run_pipeline.yaml`  
- [ ] 本地运行 `bash scripts/run_pipeline_local.sh` 看 `qc_report.json`  
- [ ] 创建 PR，检查 Actions 的报告与 Artifact  
- [ ] 让 Codex 根据 `jobcards/implement_checks.yaml` 完成检查器实现  
- [ ] 循环：我（首稿）→ Kimi（润色）→ Codex（检查与导出）→ 你（验收）

---

### 附：仓库结构（入门包）
```
patent-collab-starter/
├─ jobcards/                 # 端到端与实现任务卡
├─ schema/                   # 统一数据协议
├─ rules/                    # 禁词等规则
├─ src/checks/               # 检查器骨架与聚合脚本
├─ src/orchestrator/         # 编排占位
├─ tests/fixtures/           # 评测集样例
├─ data/drafts/              # 你的草稿
├─ .github/workflows/        # PR 自动检查
└─ scripts/                  # 本地/CI 辅助脚本
```
